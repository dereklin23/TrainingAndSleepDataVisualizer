<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>December 2025 Runs, Sleep & Oura Crown</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    #chartContainer {
      width: 2000px;
      height: 1000px;
      margin: auto;
    }
  </style>
</head>
<body>
  <h2>December 2025 Runs, Sleep & Oura Crown</h2>
  <div id="chartContainer">
    <canvas id="myChart"></canvas>
  </div>

  <script>
    async function fetchDataAndRenderChart() {
      const response = await fetch('/data');
      const data = await response.json();

      const labels = data.runs.map(r => r.date);
      const runData = data.runs.map(r => r.distance);
      const sleepData = data.sleep.map(s => s.hours);
      const crownData = data.crowns.map(c => c.score);

      const ctx = document.getElementById('myChart').getContext('2d');
      ctx.canvas.width = 2000;
      ctx.canvas.height = 1000;

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [
            {
              label: 'Distance (miles)',
              data: runData,
              borderColor: 'rgba(75, 192, 192, 1)',
              backgroundColor: 'rgba(75, 192, 192, 0.2)',
              fill: true,
              yAxisID: 'y'
            },
            {
              label: 'Sleep (hours)',
              data: sleepData,
              borderColor: 'rgba(255, 99, 132, 1)',
              backgroundColor: 'rgba(255, 99, 132, 0.2)',
              fill: true,
              yAxisID: 'y1'
            },
            {
              label: 'Oura Crown',
              data: crownData,
              borderColor: 'rgba(54, 162, 235, 1)',
              backgroundColor: 'rgba(54, 162, 235, 0.2)',
              fill: true,
              yAxisID: 'y2'
            }
          ]
        },
        options: {
          responsive: false,
          plugins: {
            legend: { position: 'top' },
            title: { display: true, text: 'December 2025 Runs, Sleep & Oura Crown' }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: { display: true, text: 'Distance (miles)' }
            },
            y1: {
              beginAtZero: true,
              position: 'right',
              title: { display: true, text: 'Sleep (hours)' },
              grid: { drawOnChartArea: false }
            },
            y2: {
              beginAtZero: true,
              position: 'right',
              offset: true,
              title: { display: true, text: 'Oura Crown (0â€“100)' },
              grid: { drawOnChartArea: false }
            },
            x: { title: { display: true, text: 'Date' } }
          }
        }
      });
    }

    fetchDataAndRenderChart();
  </script>
</body>
</html>
